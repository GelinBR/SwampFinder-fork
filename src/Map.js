import React, { useEffect, useState } from 'react';
import { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';
import {Icon} from 'leaflet';
import './styles/Map.css'
import icon from './assets/pin-logo.png'
import buildingIcon from './assets/building-pin2.png'
import { Link } from 'react-router-dom'

const positions = [
[29.650251209629328	,-82.34572378594001],
[29.64689994033195	,-82.34393444239022],
[29.65156559194852	,-82.34192844977314],
[29.631270717263753	,-82.35176163553983],
[29.63070650631546	,-82.35155778764846],
[29.64690045790346	,-82.34393197428332],
[29.647722890469115	,-82.34177614239003],
[29.727280875324873	,-82.41708282475015],
[29.64392087659595	,-82.3444107661637 ],
[29.6419079063332	,-82.3478973908517 ],
[29.63901373766613	,-82.36152251477671],
[29.64064038751308	,-82.34564776863412],
[29.64890843379099	,-82.34575609698639],
[29.651278658662118	,-82.34047547923565],
[29.617709551021342	,-82.35435768031107],
[29.649057997219053	,-82.34167235389492],
[29.638191890513188	,-82.35181662949037],
[29.642704564393366	,-82.34795677428347],
[29.65089758538994	,-82.34413751967311],
[29.640789076638068	,-82.34487316677581],
[29.64618858658385	,-82.3465643963536 ],
[29.643861678406374	,-82.34486923931296],
[29.648314573982734	,-82.34430796723343],
[29.639692934468687	,-82.3500345250608 ],
[29.64982496093201	,-82.34500611599913],
[29.634618237024814	,-82.36647765824405],
[29.648306295796324	,-82.33977204483551],
[29.64775033900143	,-82.34043522101729],
[29.6483738962002	,-82.34014822465099],
[29.63838902359664	,-82.36119563747907],
[29.64661906464058	,-82.3543598153879 ],
[29.64949815798147	,-82.34726725526959],
[29.651450200916194	,-82.34397634298077],
[29.650114542515972	,-82.34377249509494],
[29.64690544439495	,-82.34441046018114],
[29.650761695894644	,-82.34007502704449],
[29.645900691847853	,-82.35108576814928],
[29.649271895681075	,-82.3420559356447 ],
[29.650407447630016	,-82.34067492274444],
[29.642076451275877	,-82.34438406567442],
[29.649763578890102	,-82.35915060373094],
[29.641643312728878	,-82.3452055215221 ],
[29.644460724190463	,-82.35245742505899],
[29.651675991024703	,-82.33981258286262],
[29.645311020983055	,-82.34235474285873],
[29.65072688070888	,-82.33483845281224],
[29.646025906235597	,-82.34566298720425],
[29.649592668190802	,-82.34659349389293],
[29.643110107776373	,-82.34737209622303],
[29.65046061933076	,-82.34428284231828],
[29.64887849241875	,-82.34073896202335],
[29.643325919126468	,-82.34829920803283],
[29.646347985643818	,-82.34945567306058],
[29.647351740668615	,-82.34950690311972],
[29.644033405811154	,-82.34774804457838],
[29.65165756142413	,-82.34103805329244],
[29.641919562319597	,-82.34326651233131],
[29.646987507634396	,-82.34554303610973],
[29.646763723720166	,-82.34492746913256],
[29.646694956689316	,-82.34536466921536],
[29.646520125038613	,-82.34431860768008],
[29.63996841265215	,-82.362818009254  ],
[29.64885915117986	,-82.35933225771606],
[29.64040054540441	,-82.34464979016086],
[29.64825200847732	,-82.34296455027679],
[29.642788722151273	,-82.34611590124771],
[29.633673979246105	,-82.36736252525334],
[29.642311479835417	,-82.3471651373691 ],
[29.644013920154396	,-82.34973684345657],
[29.64625635835991	,-82.33799703012241],
[29.646802386747297	,-82.33811726387238],
[29.646655528341903	,-82.3376170318758 ],
[29.647406955213835	,-82.34801837458136],
[29.645421978190658	,-82.34572411269902],
[29.644613399366335	,-82.34886657367886],
[29.64999530363516	,-82.34727058174781],
[29.639489037414805	,-82.35961088694908],
[29.64347106357155	,-82.34632059256288],
[29.649462478428855	,-82.34569467371324],
[29.647971771237188	,-82.34813212643621],
[29.646984356275986	,-82.34319513857734],
[29.644473988032075	,-82.34544196814932],
[29.649278538632082	,-82.34449145450719],
[29.64762754790532	,-82.34263038484794],
[29.651432653136368	,-82.34442640100154],
[29.650050479161205	,-82.34428244586864],
[29.649486193824725	,-82.351170474576  ],
[29.650874925302702	,-82.34115977673098],
[29.64919849222455	,-82.34405868833171],
[29.650450431760586	,-82.34691679632697],
[29.648578100594268	,-82.35112920312378],
[29.64851352334433	,-82.33069732887867],
[29.64851352334433	,-82.33069732887867],
[29.64837837996477	,-82.34850623120367],
[29.647833251077408	,-82.34743658902073],
[29.647118804888358	,-82.34798676055355],
[29.647956104753447	,-82.34664476050325],
[29.639189103288246	,-82.36377075649266],
[29.64994260023541	,-82.34778447290772],
[29.63460596093135	,-82.36567094422469],
[29.625519468580237	,-82.35383804362118]]


const iconScale=0.03;

const customIcon = new Icon({
    iconUrl: buildingIcon, // URL to your custom icon
    iconSize: [1200*iconScale, 1600*iconScale], // Size of the icon
    iconAnchor: [600 * iconScale, 1600 * iconScale] // Anchor point at the center-bottom
});

const userIcon = new Icon({
    iconUrl: icon,
    iconSize: [64,64],
    iconAnchor: [32, 64]
})

const Map = () => {

    const [userLocation, setUserLocation] = useState(null);

    useEffect(() => {
        if ("geolocation" in navigator) {
          navigator.geolocation.getCurrentPosition((position) => {
            const { latitude, longitude } = position.coords;
            setUserLocation([latitude, longitude]);
          });
        }
      }, []);

  return (
    <div>
        <MapContainer center={userLocation ? userLocation : positions[0]} zoom={13} style={{ height: "100vh", width: "100%" }}>
        <TileLayer
            url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
        />
            {positions.map((position, index) => (
                    <Marker key={index} position={position} icon={customIcon}>
                        <Popup>
                            Marker {index + 1}: {position[0]}, {position[1]}
                            <br />
                            <Link to={'/moreinfo'}>Building Info ...</Link>
                        </Popup>
                    </Marker>
                ))};
                {userLocation && (
                        <Marker position={userLocation} icon={userIcon}>
                          <Popup>You are here</Popup>
                        </Marker>
                    )};
        </MapContainer>
    </div>
  );
};

export default Map;